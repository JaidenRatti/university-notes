\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{xhfill}
\usepackage[a4paper, margin=1in]{geometry}
\usepackage{parskip}
\usepackage{fancyhdr}
\usepackage{color,soul}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{comment}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{blindtext}
\usepackage{titlesec}

\newcommand\mc{\mathcal}


\pagestyle{fancy}
\lhead{1241}
\chead{MATH 239: Introduction to Combinatorics}
\rhead{Jaiden Ratti}

\usepackage{minted}
\large
\title{MATH239 Enumerative Combinatorics}
\begin{document}
\begin{titlepage}
	\begin{center}
    \line(1,0){300}\\
    [0.65cm]
	\huge{\bfseries Introduction To Combinatorics}\\
	\line(1,0){300}\\
	\textsc{\Large MATH239}\\
	\textsc{\Large  Jaiden Ratti}\\
        \textsc{\Large Prof. Kevin Hare}\\
        \Large Part 1: Enumerative Combinatorics\\
	[5.5cm]
	\end{center}
\end{titlepage}




\tableofcontents

\pagebreak

\section{Basic Principles}

\subsection{Combinatorics}

The study of combinatorics is the study of counting things. 

\begin{enumerate}
    \item How many possible poker hands are there?
    \item How many ways can we choose a 3 topping pizza with 10 toppings?
    \item How many ways can we split 8 slices of pizza between 3 people?
    \item How many ways can we make change for a dollar?
\end{enumerate}

\underline{Notation}

$A = \{a_1, a_2, ..., a_n\}$ is an n-element set. 
\begin{itemize}
    \item All terms are different
    \item Order of terms does not matter, $\{1,2\} = \{2,1\}$
\end{itemize}

\underline{Example}

Let $A$ be the set of primes less than 10, $A = \{2,3,5,7\}$. 

Let $B$ be the set of odd numbers less than 10, $B = \{1,3,5,7,9\}$.

We denote the size of a set by $|A|$.

\underline{Example}

From above, $|A|= 4$, $|B| = 5$.

\underline{Example}

Choose a prime less than 10 \underline{and} an odd number less than 10. I.e. $(2,1),(2,3),...,(7,9)$.

For this, we use the notation of $A \times B = \{(a,b): a \in A, b \in B\}$

We have $|A \times B| = |A| \cdot |B|$

In this case, $(A \times B) = 4 \cdot 5 = 20$

\underline{Example}

Choose a prime less than 10 \underline{or} choose an odd number less than 10. 

Choices are 1,2,3,5,7,9. This is denoted by $A \cup B = \{x: x \in A$  or  $x \in B \}$ (or $x$ is in both).  

$|A \cup B| = 6$

\underline{Example}

Choose a number less than 10 that is prime and an odd number $\{3,5,7\}$

We denote this by $A \cap B = \{x: x \in A$ and $x \in B\}$ 

\underline{Fact} $|A \cup B| = |A| + |B| - |A \cap B|$

\underline{Definition} Let A be a set. We define a list of A as the set of elements of A where the order matters

\underline{Example}

Let $A = \{2,3,5,7\}$ be the set of primes less than 10. 

The possible lists of A include

(2,3,5,7)(3,2,5,7)(5,2,3,7)(7,2,3,5)(2,3,7,5)(2,5,3,7)(2,5,7,3)(2,7,5,3)(2,7,3,5)$\ldots$(3,7,2,5) (5,7,3,2)(7,5,3,2)

In this case there are 24 lists of $A = \{2,3,5,7\}$

Note, all elements in A will occur exactly once in each list. That is, lists are length $|A|$. 

\underline{Question}: Let A be a set with $|A| = n$. How many lists of A are there?

Let $p_n$ be the number of lists of $A$ where $|A| = n$. We can partition the set of lists based upon the first element of the list. 

There are $n$ choices for this first element. Let $x \in A$ be the first element of a list. The remainder of the list will be chosen from the list of $A \setminus \{x\}$.

Note that $|A \setminus \{x\} | = n - 1$

Hence there are $p_{n-1}$ choices for the last $n-1$ elements of the list. As there were $n$ choices for $x$, we get $p_n = n \cdot p_{n-1}$.

Note $p_1 = 1$ (the only list from $\{x\}$ is $(x)$). 

Hence  $p_n = n \cdot p_{n-1} = n \cdot (n-1) \cdot p_{n-2} \ldots = n(n-1) \ldots (2)p_1 = n!$

\underline{Theorem} 

Let $A$ be a set with $|A| = n$. Then the number of lists of $A$ is $n!$

\underline{Definition}

A subset of a set is a collection of elements from $A$ without repetition. Note a subset may be empty, or all of $A$. Order does not matter.

\underline{Example} 

Let $A = \{2,3,5,7\}$. The set of all subsets includes

$\{\}, \{2\}, \{3\}, \{5\}, \{7\}, \{2,3\}, \{2,5\}, \{2,7\}... 16$

We see that for each $x \in A$ a subset either contains $x$, or doesn't contain $x$. This gives us two choices for all $x \in A$. Either it is in the subset or it is not. 

This allows us to observe that the number of subsets of $A$ where $|A| = n$, is $2^n$. 

\underline{Theorem}

The number of subsets of $A$ with $|A| = n$, is $2^n$ (include or not; 2 options $n$ times). 

\underline{Definition}

Let $A$ be a set of size $n$. A partial list of size $k$ is an ordered list $(a_1, a_2, \ldots, a_k)$ with $a_i \in A$ and no repeats. 

\underline{Example}

Let $A = \{2,3,5,7\}$. Let $k = 2$. The partial lists of length $2$ of $A$ are

(2,3),(3,2),(2,5),(5,2)

(2,7),(7,2),(3,5),(5,3)

(3,7),(7,3),(5,7),(7,5)

\underline{Question}

For every $n$ and $k$, how many partial lists of length $k$ are there of $\{1,2,\ldots,n\}$

\underline{Notice}

In the previous example, there are $4$ choices for the first element of the list. After we have chosen the first element, we have only 3 choices for the second. After, we are done. 

This gives us the number of partial lists is $4 \cdot 3 = 12$

In general, for $|A| = n$, and $k \le n$, we have

\begin{enumerate}
    \item $n$ choices or the first element
    \item $n-1$ choices or the second
\end{enumerate}

\vdots
k. $n-k-1$ choices for the $k^{th}$ element

\underline{this gives}

\underline{Theorem}

The number of partial lists of length $k$ of $\{1,2,\ldots,n\}$ is 

\begin{equation*}
n(n-1)(n-2)...(n-k+1)
= \frac{n(n-1)(n-2)...(n-k+1)(n-k)...(2)(1)}{(n-k)(n-k-1)..(2)(1)}
= \frac{n!}{(n-k)!}
\end{equation*}

\underline{Example}

Find all of the subsets of size $2$ of $\{2,3,5,7\}$ 

$\{2,3\},\{2,5\},\{2,7\},\{3,5\},\{3,7\},\{5,7\}$

For every subset of length $k$ there are $k!$ orderings of the elements to get a partial list of length $k$. This is true for every subset.

This gives us that 

(\# of subsets of size $k$ of $\{1,2,\ldots,n\}$) $ \cdot k! =$ \# of partial lists of length $k$ of $\{1,2,\ldots,n\}$

\underline{Theorem}

Let $A$ be a set $|A| = n$, and $k \le n$. Then the number of subsets of subsets of size $k$ is

\begin{equation*}
\frac{n!}{(n-k)!k!} = \binom{n}{k}
=\frac{\text{number of partial lists}}{k!}
=\text{number of subsets}
\end{equation*}

\subsection{Meaning vs Algebra}

There are many examples in combinatorics where we can manipulate the algebra to get a result or relationship. 

This will tell you that something is true, but not \underline{why} it is true. 

We wish to find relationships between things we know how to count and things we want to count. 

\underline{Example}

Show $\binom{n}{k} = \binom{n}{n-k}$

We see that $\binom{n}{k}$ is the number of subsets of size $k$ of $\{1,2,\ldots,n\}$.

Let $S = \{a_1,a_2,\ldots,a_k\}$ be a subset of size $k$ of $\{1,\ldots,n\}$. 

\underline{Notice}

$S' = \{1,2,\ldots,n\} \setminus S$ is a subset of size $n-k$. 

(I.e if $n=10$, $A = \{2,3,5,7\}$ then $A^c = \{1,4,6,8,9,10\}$). 

We see every $A$, a subset of size $k$ corresponds to a unique $A^c$, a subset of size $n-k$. Further every subset of size $n-k$ can be constructed in this way. 

This tells us that the number of subsets of size $k$ is the same as the number of subsets of size $n-k$. 


\subsection{Bijections}

\underline{Definition} Let $A$ and $B$ be sets.

\begin{enumerate}
    \item A map $f: A \to B $ is said to be surjective (onto) if $\forall b \in B$ there exists (at least one) $a \in A$ with $f(a)=b$ (all $b$'s are covered). 

\underline{Example}

$f: \{1,2,3,4\} \to \{1,2\}$ by $f(1) = 1, f(2) = f(3) = f(4) = 2$

\item A map $f: A \to B$ is said to be injective if every $a \in A$ maps to a unique $b \in B$ (Sometimes called one-to-one). 

\underline{Example}

$f: \{1,2\} \to \{1,2,3,4\}$ by $f(1) = 2, f(2) = 4$

\item A map $f: A \to B$ is called bijective (or one-to-one \& onto) if it is both surjective and injective.

\end{enumerate}

\underline{Example}

$f: \{1,2,3\} \to \{2,3,5\}$ by $f(1)=2, f(2)=3, f(3)=5$

Note, bijections can be reversed. 

\underline{See}

$f^{-1}(2) = 1$
$f^{-1}(3)=2$
$f^{-1}(5)=3$

\underline{Observation}

\begin{enumerate}
    \item If there is a surjection $f: A \to B$, then $|A| \ge |B|$
    \item If there is an injection $f: A \to B$, then $|A| \le |B|$
    \item If there is a bijection $f: A \to B$, then $|A| = |B|$
\end{enumerate}

\underline{Notation} If there is a bijection $f: A \to B$, we say $A \leftrightharpoons$ B.


\underline{Example}

Show 
\begin{equation*}
\binom{n}{k} = \binom{n-1}{k-1} + \binom{n-1}{k}
\end{equation*}
Let $B(n,k)$ be the set of subsets of $\{1,\ldots,n\}$ of size $k$.

\underline{Notice}

\begin{align*}
   |B(n,k)| &= \binom{n}{k} \\
   |B(n-1,k-1)| &= \binom{n-1}{k-1} \\ 
   |B(n-1,k-1)| &= \binom{n-1}{k} \\
\end{align*}

\underline{Ex} $B(3,2) = \{ \{1,2\}, \{1,3\}, \{2,3\} \}$ all subsets of size $2$ of numbers from $1-3$. 

Our goal is to get a bijection from $B(n,k)$ to $B(n-1,k-1) \cup B(n-1,k)$

Notice $B(n-1,k-1)$ and $B(n-1,k)$ are disjoint (since they have different sizes). This gives, 

$|B(n-1,k-1) \cup B(n-1,k)| = | B(n-1,k-1)| + |B(n-1, k)|$


We will construct a map $f$ with 

$f: B(n,k) \to B(n-1,k-1) \cup B(n-1, k)$  by 

$f(\{a_1,a_2,\ldots,a_k\}) = \{a_1,\ldots,a_k\} \setminus \{n\}$ 

If $n \notin \{a_1,a_2,\ldots,a_k\}$ we see $f(\{a_1,\ldots,a_k\}) = \{a_1,\ldots,a_k\} \in B(n-1, k)$

If $n \in \{a_1,a_2,\ldots,a_k\}$ then $f(\{a_1,\ldots,a_k\})$ is size $k-1$ and uses numbers $\{1,\ldots,n-1\}$. 

This gives $f(\{a_1,\ldots,a_k\}) \in B(n-1,k-1)$

Question: Is this a bijection? 

Notice if $n \notin \{a_1,\ldots,a_k\}$ this map is injective and surjective. The inverse map is $f^{-1}(\{a_1,\ldots,a_k\}) = \{a_1,\ldots,a_k\}$.

If $n \in \{a_1, \ldots, a_k\}$, say 

$\{a_1,\ldots,a_k\} = \{a_1,\ldots,a_{k-1}, n\}$ and $f^{-1}(\{a_1,\ldots, a_{k-1}, n\}) = \{a_1, \ldots, a_{k-1}\} \cup \{n\}$

This gives us that $f$ is a bijection. Hence

$|B(n,k)| = |B(n-1, k)| + |B(n-1, k-1)|$

$\implies \binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1}$ as required. 

\underline{Definition}

Let $n \ge 0 $, and $t \ge 1$. A multiset of size $n$ with $t$ types is a list $(a_1, \ldots, a_t)$ where $a_1 + \ldots + a_t = n$

\underline{Example} A person has $10$ pets, (fish, cats, and dogs)

Here $n=10, t=3$. We can have the list $(7,2,1)$.

We could have $t=4$ types (last type being birds). Then we have $(7,2,1,0)$ fish, cats, dogs, and birds respectively. 

\underline{Theorem}

The number of multisets of n with t types is 
\begin{align*}
    \binom{n+t-1}{t-1}
\end{align*}

\underline{Proof}

We will do this by a bijective method. Let $A$ be the set of subsets of size $t-1$ of $\{1,\ldots,n+t-1\}$. 

Clearly $|A| = \binom{n+t-1}{t-1}$

Let $B$ be our set of multisets of size $n$ with $t$ types. 

For example, we could have $n=10, t=4$.

Consider the subject $A$ given by

$\circ \circ \circ \circ \circ \circ \circ \bullet \circ \circ \bullet \circ \bullet$

Here there are $13 = n+t-1$ circles, of which $3=t-1$ are erased off. 

$\underbrace{(\circ \circ \circ \circ \circ \circ \circ)}_{\text{7 fish}} \bullet \underbrace{(\circ \circ)}_{\text{2 cats}} \bullet \underbrace{(\circ)}_{\text{1 dog}} \bullet \underbrace{}_{\text{0 birds}}$

This (admittedly non-rigorously defined) map is a bijection from $A$ to $B$. 

This gives us $|A| = |B|$



\section{Generating Series}

\subsection{Formal Power Series}

In Math138 we considered power series/Taylor series, etc. Key difference in Math239 is we don't care about convergence. 

What we care about are the coefficients and the information they carry. 

\underline{Definition}

A formal power series $A(x) = \sum_{n=0}^{\infty} a_nx^n = a_0 + a_1x + a_2x^2 + \ldots$

\underline{Note}: Often the $a_n$ are positive integers, and typically represent the size of some set we are interested in. 

\underline{Example}: Let $a_n$ be the number of lists of $\{1,2,\ldots,n\}$. In this case $a_n = n!$

We create the power series

\begin{align*}
A(x) = \sum_{n=0}^{\infty} a_nx^n = \sum_{n=0}^{\infty}n!x^n = 1 + x + 2x^2 + 6x^3
\end{align*}

\underline{Note}: This only converges at $x=0$. We don't care. 

We can (and do) add and multiply formal power series in the obvious way. 

\underline{Example}

\begin{align*}
\sum_{n=0}^{\infty}a_nx^n + \sum_{n=0}^{\infty}b_nx^n = \sum_{n=0}^{\infty}(a_n+b_n)x^n
\end{align*}

\underline{Example}

\begin{align*}
(\sum_{n=0}^{\infty}a_nx^n)(\sum_{n=0}^{\infty}b_nx^n) &= 
(a_0 + a_1x + a_2x^2 + \ldots) \cdot (b_0 + b_1x + b_2x^2 + \ldots) \\
&= a_0b_o + (a_0b_1 + a_1b_0)x + (a_0b_2 + a_1b_1 + a_2b_0)x^2 \\
&= \sum_{n=0}^{\infty} (\sum_{k=0}^{n}a_kb_{n-k})x^n
\end{align*}

\underline{Note}

We often call $x$ an indeterminate, not a variable. A variable is a placeholder that we occasionally evaluate at. We (almost never) evaluate at $x$. Hence we call it an indeterminate. 

We often manipulate formal power series algebraically disregarding convergences. 

\underline{Example}

Let $A(x) = \sum_{n=0}^{\infty}x^n = 1 + x + x^2 + \ldots$

Notice $x \cdot A(x) = x + x^2 + x^3 + \ldots$

This gives $A(x) - xA(x) = 1 + 0x + 0x^2 + 0x^3 + \ldots = 1$

Or equivalently, 

$(1-x)(A(x)) = 1$

Or 
\begin{align*}
A(x) &= \frac{1}{1-x} \leftarrow \text{(not a formal power series)} \\
(1-x) &= \frac{1}{A(x)} \leftarrow \text{(not a formal power series)} \\
\end{align*}

\underline{Theorem}

Let $n \ge 0$ be fixed. Let $a_k$ be the number of subsets of $\{1,2,\ldots,n\}$ of size $k$. 

\underline{Show}

\begin{align*}
    \sum_{k=0}^{\infty}a_kx^k = \sum_{k=0}^{n}a_kx^k = \sum_{k=0}^{\infty}\binom{n}{k}x^k = (1+x)^n
\end{align*}

\underline{Note} if $k > n$, then $a_k = 0$. Hence the first equality (everything after $n$ is 0)

Second equality comes from previous work $(a_k = \binom{n}{k})$

Let $P(n)$ be the set of all subsets of $\{1,2,\ldots,n\}$

Let $B = $ set of all $(b_1, \ldots, b_n)$ with $b_i \in \{0,1\}$

Let $f(\{c_1,\ldots,c_k\}) = (b_1,\ldots,b_n)$ where $b_i = \begin{cases} 
  1 & \text{if } i \in \{c_1, \ldots, c_k\} \\
  0 & \text{if } i \notin \{c_1, \ldots, c_k\}
\end{cases}$

Let $n=10$

$f(\{1,2,5,7\}) = (\underbrace{1}_{1},\underbrace{1}_{2},0,0,\underbrace{1}_{5},0,\underbrace{1}_{7},0,0,0)$

We see $f^{-1}((b_1, \ldots, b_n)) = \{ i : b_1 = 1\}$
$f^{-1}((0,1,1,0,1)) = \{2,3,5\}$

We have 

\begin{align*}
\sum_{k=0}^{n}a_kx^k = \sum_{k=0}^{n}\sum_{\{c_1,\ldots,c_k\} \text{}}x^k &= \sum_{k=0}^{n}\sum_{(b_1,\ldots,b_n) \sum_{b_i}=k} x^{b_1+\ldots+b_k} \\
&= \sum_{(b_1,\ldots,b_n)\in B} x^{b_1+\ldots+b_n} \\
&= \sum_{b_1 \in \{0,1\}b_2\in \{0,1\}b_n \in \{0,1\}}x^{b_1+\ldots+b_n} \\
&= \sum_{b_1\in \{0,1\}} \sum_{b_2\in\{0,1\}} \ldots \sum_{b_n \in \{0,1\}} x^{b_1+\ldots+b_n} \\
&= \sum_{b_1\in \{0,1\}} \sum_{b_2\in\{0,1\}} \ldots \sum_{b_n \in \{0,1\}} x^{b_1+\ldots+b_n} \\
&= \sum_{b_1 \in \{0,1\}} x^{b_1} \sum_{b_2 \in \{0,1\}}x^{b_2} \ldots \sum_{b_n \in \{0,1\}}x^{b_n} \\
&= (1+x)(1+x)\ldots(1+x) \\
&=(1+x)^n
\end{align*}

\underline{Example}

Show
\begin{align*}
\binom{m+n}{k} = \sum_{j=0}^{k}\binom{m}{j}\binom{n}{k-j}
\end{align*}

Notice 
\begin{align*}
(1+x)^{m+n} = \sum_{k=0}^{m+n}\binom{m+n}{k}x^k
\end{align*}

Further,

\begin{align*}
    (1+x)^{m+n} &= (1+x)^m(1+x)^n \\ 
    &= (\sum_{j=0}^{m}\binom{m}{j}x^j)(\sum_{i=0}^{n}\binom{n}{i}x^i)
\end{align*}

This gives us

\begin{align*}
    (1+x)^{m+n} &= \sum_{j=0}^{m}\sum_{i=0}^{n}\binom{m}{j}\binom{n}{i}x^{j+1} \\
    &= \sum_{k=0}^{m+n}\sum_{i+j=k}^{}\binom{m}{j}\binom{n}{i}x^{j+i} \\
    &= \sum_{k=0}^{m+n}\sum_{i+j=k}^{}\binom{m}{j}\binom{n}{k-j}x^k \\
    &= \sum_{k=0}^{m+n}\sum_{j=0}^{k}\binom{m}{j}\binom{n}{k-j}x^k
\end{align*}

By looking at the coefficient in front of $x^k$ we get that left hand side $=$ right hand side. 

Notation, $[x^k](\sum_{}^{}a_kx^k) = a_k =$ coefficient in front of $ x^a$.

\subsection{Generating Series}

Let $g_1, g_2, \ldots$ be a sequence of numbers that we care about and encode some information. 

\underline{Example}

$g_n = \#$ of binary strings of length $n$

$g_n = \#$ of partial lists of length $n$ of $\{1,2,\ldots,100\}$

\underline{Definition}

We define the generating series as

$G(x) = \sum_{n=0}^{\infty}g_nx^n$

We often generate these series using a weight function.

\underline{Definition}

Let $A$ be a set. We say $w$ is a weight function where $\omega: A \to \mathbb{N}$. We further require that 

$A_n = \omega^{-1}(n) = \{a \in A: \omega(a) = n\}$ is a finite set $\forall n$.

\underline{Example}

Let $A$ = the set of all binary strings of any length. 

I.e. $A = \{\epsilon, 0, 1, 00, 01, 10, 11, 000, \ldots \}$

Good choices for $\omega$
\begin{itemize}
    \item The length of the string (in this case $|A_n| = 2^n$)
\end{itemize}

Bad choice for $\omega$
\begin{itemize}
    \item The number of $1$'s in the string
\end{itemize}

I.e. $A = \{1,10,01,1000,1000,\ldots\}$

Here $A_1$ is infinite.

\underline{Example}

Let $A$ be the set of all subsets of $\{1,2,\ldots,10\}$

Define $\omega : A \to \mathbb{N}$ by $w(\{a_1,\ldots,a_k\}) = |\{a_1,\ldots,a_k\}| = k$

\begin{align*}
    A_0 &= \omega^{-1}(0) = \{\{\}\} \\
    A_1 &= \omega^{-1}(1) = \{\{1\},\{2\},\ldots,\{10\}\} \\
    \vdots \\
    A_{10} &= \omega^{-1}(10) = \{1,2,3,4,5,6,7,8,9,10\}\\
    A_{11} &= \{\}, A_n = \{\} \text{ for } n \ge 11
\end{align*}

\underline{Definition}

We define the generating series for $A$ with respect to $\omega$ as

$\Phi_{A}^{\omega}(x) = \sum_{a \in A}^{}x^{\omega(a)}$

In this case,
\begin{align*}
\Phi_{A}^{\omega}(x) &= x^{\omega(\{\})} + x^{\omega(\{1\})} + x^{\omega(\{2\})} + \ldots + x^{\omega\{1,2,\ldots,10\})} \\
&= x^0 + \underbrace{x^1 + \ldots + x^1}_{10 \text{ subsets of size } 1} + \underbrace{x^2 + \ldots + x^2}_{10 \text{ subsets of size } 2} + \ldots + x^{10} \\
&= x^0 + \binom{10}{1}x + \binom{10}{2}x^2 + \ldots + \binom{10}{9}x^9 + \binom{10}{10}x^{10} \\
&= \sum_{n=0}^{10}|A_n|x^n \\
&= \sum_{n=0}^{\infty}|A_n|x^n \\
&= \sum_{n=0}^{10}\binom{10}{n}x^n
\end{align*}

Note $|A_n| = \#$ of subsets of size $n$ taken from $\{1,\ldots,10\} = \binom{10}{n}$

\underline{Theorem}

Let $A$ be a set and $\omega$ a weight function. Then

\begin{align*}
    \Phi_{A}^{\omega}(x) &= \sum_{a \in A}^{}x^{\omega(a)} = \sum_{n=0}^{\infty}|A_n|x^{n}
\end{align*}

\begin{align*}
    \sum_{a \in A}^{}x^{\omega(a)} &= \sum_{a \in A_0 \cup A_1 \cup A_2 \ldots}^{}x^{\omega(a)} \\
    &= \sum_{n=0}^{\infty}\sum_{a\in A_n}^{}x^{\omega(a)} \\
    &= \sum_{n=0}^{\infty}\sum_{a\in A_n}^{}x^{n} \\
    &= \sum_{n=0}^{\infty}\sum_{a\in A_n}1 \\
    &= \sum_{n=0}^{\infty}x^n|A_n| \\
    &= \sum_{n=0}^{\infty}|A_n|x^n \text{ as required.}
\end{align*}

\underline{Theorem}

Let $g_n = \#$ of multisets of $n$ with $t$ types $= \binom{n+t-1}{t-1}$

Use generating series to show

\begin{align*}
    \sum_{n=0}^{\infty}g_nx^n = \sum_{n=0}^{\infty}\binom{n+t-1}{t-1}x^n = \frac{1}{(1-x)^t}
\end{align*}

\underline{Question} What is $A$ and what is $\omega$?

We want $A_n$ to be all the multisets of $n$ with $t$ types. 

That is 

$A_n = \{(a_1,\ldots,a_t): a_1 + a_2 + \ldots + a_t = n\}$

We can define $w((a_1,\ldots,a_k))=a_1 + \ldots + a_t$

We can use 
\begin{align*}
A &= \{(a_1,\ldots,a_t):a_1,\ldots,a_t \in \mathbb{N}\} \\
&= \underbrace{\mathbb{N} \times \mathbb{N} \times \mathbb{N} \times \ldots \times \mathbb{N}}_{t \text{ times}} \\
&= \mathbb{N}^t
\end{align*}

This gives

\begin{align*}
    \sum_{}^{}\binom{n+t-1}{t-1}x^n &= \sum_{a \in A}x^{\omega(a)} = \sum_{n=0}^{\infty}|A_n|x^n \\
    \sum_{a \in A}x^{\omega(a)} &= \sum_{(a_1,\ldots,a_t)\in A} x^{a_1 + \ldots a_t} \\
    &= \sum_{a_1 = 0 \ldots \infty a_2 = 0 \ldots \infty a_t = 0 \ldots \infty}^{} x^{a_1}x^{a_2}\ldots x^{a_t} \\
    &= (\sum_{a_1=0}^{\infty}x^{a_1})(\sum_{a_2=0}^{\infty}x^{a_2})\ldots(\sum_{a_t=0}^{\infty}x^{a_t}) \\
    &= (\frac{1}{1-x})(\frac{1}{1-x})\ldots(\frac{1}{1-x}) \\
    &= (\frac{1}{1-x})^t
\end{align*}

Recall from Math138 that 

$\frac{1}{1-x} = 1+x+x^2+x^3+\ldots \forall |x| \le 1$

We don't care about convergence. 

We notice from this that

$1 = (1-x)(1+x+x^2+\ldots)$

Both $(1-x)$ and $(1+x+x+^2+\ldots)$ are formal power series. 

\underline{Definition}

Let $A(x)$ and $B(x)$ be formal power series. If $A(x)B(x)=1$, then we say $A(x)$ is an inverse of $B(x)$ and similarly $B(x)$ is an inverse of $A(x)$.

\underline{Example} 

Let $A(x) = 1-x-x^2$

Find $B(x)$ (if it exists) such that $A(x)B(x)=1$

Write $B(x) = b_0 + b_1x + b_2x^2 + b_3x^3 + \ldots$

This gives

$A(x)B(x) = (1-x-x^2)(b_0+b_1x+b_2x^2+\ldots) = b_0 + (b_1 - b_0)x + (b_2 - b_1 - b_0)x^2 + (b_3 - b_2 - b_1) x^3 + \ldots$

Notice $[x^0]1 = 1. [x^0]A(x)B(x)=b_0$. Hence $b_0 = 1$

$[x^1]1=$ coefficient in front $x^1$ of the power series $= 0$.

$[x^1]A(x)B(x)=b_1-b_0 = b_1-1$. Hence $b_1 = 1$

Next $[x^2]1 = 0$

$[x^2]A(x)B(x) = b_2-b_1-b_0$

Hence $b_2 = 2$

For general $n \ge 2$ we have.

$[x^n]1=0$

$[x^n]A(x)B(x) = b_n - b_{n-1}-b_{n-2}$

$\implies b_n = b_{n-1} + b_{n-2}$

Notice

$b_0=1, b_1=1,b_2=2, b_3=3, b_4=5, b_5=8, b_6=13,\ldots$

This is the Fibonacci sequence. 

I.e $(1-x-x)(1+x+2x^2+3x^3+5x^4+8x^5+\ldots) = 1$

We found the inverse.

\underline{Example}

Show $A(x)=x+x^2$ does not have an inverse.

Assume it does, say

$B(x)=b_0+b_1x+b_2x^2+\ldots$

As before we will consider $A(x)B(x)=1$, and match coefficients for $x^n$ for various $n$. I.e. consider

$[x^n]1 = [x^n]A(x)B(x)$

For $n=0, [x^0]1=1$

$A(x)B(x) = b_0x + (b_1 + b_0)x^2 + (b_2+b_1)x^3+\ldots$

For $n=0 [x^0]A(x)B(x)=0$

Note $1 \ne 0$, hence there are no solutions, and there is no inverse. 

\underline{Theorem}

Let $A(x) = a_0 + a_1x + \ldots$ be a formal power series. Then there exists an inverse $B(x) \iff a_0 \ne 0$

Let $A(x)$ and $B(x)$ be formal power series. We define the composition as 

$A(B(x)) = a_0 + a_1B(x) + a_2B(x)^2+\ldots$ (assuming it exists)

\underline{Example}

Let $A(x) = 1+x+x^2+\ldots$
Let $B(x) = x+x^2$

So 
\begin{align*}
A(B(x)) &= 1+(x+x^2)+(x+x^2)^2 + (x+x^2)^3+\ldots\\
&= 1+x+2x^2+3x^3+5x^4+8x^5+\ldots
\end{align*}

Note: This series is the same as the inverse of $(1-x-x^2)$. Why?

\underline{Example} Let $A(x)$ be as before, $(1+x+x^2+x^3+\ldots)$ and $B(x) = 1+x$

\begin{align*}
    A(B(x)) &= 1 + (1+x) + (1+x)^2 + (1+x)^3 + \ldots \\
    &= \infty + \infty x + \infty x^2 + \ldots \leftarrow \text{Garbage}
\end{align*}

The composition is not well defined. 

\underline{Theorem} Let $A(x)$ and $B(x)$ be formal power series. $B(x)=b_0+b_1x+b_2x^2+\ldots$

If $b_0$ then $A(B(x))$ is well defined. 

\underline{Pf}

Assume $b_0=0$. We can write $B(x)=xC(x)$

\begin{align*}
\text{Hence } A(B(x)) &= A(xC(x))\\
&= a_0 + a_1xC(x) + a_2x^2C(x)^2 + \ldots
\end{align*}

Notice $[x^n]A(xC(x)) = [x^n]\sum_{k=0}^{n}a_kx^kC(x)^k$

This sum is finite, hence all coefficients are finite. 

\underline{Definition}

We say that a power series $A(x)$ is rational if there exists polynomials $P(x)$ and $Q(x)$ such that

$\frac{P(x)}{Q(x)} = A(x)$ or $P(x) = Q(x)A(x)$

\underline{Example}

Let $A(x) = 1+x+2x^2+3x^3+5x^4+8x^5$

Notice $A(x) = \frac{1}{1-x-x^2}$, hence $A(x)$ is rational. 

\underline{Example}

Let $A(x) = 1+\frac{1}{2}x-\frac{1}{8}x^2+\frac{1}{16}x^3-\frac{5}{128}x^4+\ldots$ such that $A(x)A(x) = 1+x$

\textit{Exercise} show $A(x)$ is not rational.

\subsection{Sum Lemma}

Let $A$ and $B$ be sets.

Let $A \cap B = \emptyset$ and $S=A\cup B$

Let $\omega$ be a weight function defined on $S$ (and hence $A$ and $B$)

Then
\begin{align*}
\Phi_S^{\omega}(x) = \Phi_A^{\omega}(x) + \Phi_B^{\omega}(x)
\end{align*}

\underline{Proof}

\begin{align*}
    \Phi_S^{\omega}(x) = \sum_{s \in S}x^{\omega(s)} &= \sum_{s\in A \cup B}x^{\omega(s)} \\
    &= \sum_{s \in A \text{ or } s \in B}x^{\omega(s)} \\
    &= \sum_{s \in A}x^{\omega(s)} + \sum_{s \in B}x^{\omega(s)} \\
    &= \Phi_A^{\omega}(x) + \Phi_{B}^{\omega}(x)
\end{align*}

Note 

\begin{align*}
\Phi_A^{\omega} &= \sum_{n=0}^{\infty}|A_n|x^b \\
&= \sum_{s \in S}x^{\omega(s)}
\end{align*}

here, $A_n = \omega^{-1}(n) = \{s \in S: \omega(s)=n\}$

\underline{Example}

Let $A$ be the subsets of $\{1,2,\ldots,n\}$ that contain $n$, and $B$ is all the subsets from $\{1,\ldots,n\}$ that do not contain $n$. 

$A \cup B = \emptyset$

Further, $S=A \cup B$ is all the subsets of $\{1,\ldots,n\}$

Let $w(\{c_1,\ldots,c_k\}) = |\{c_1,\ldots,c_k\}|$ be the size of the subset.

Then $\Phi_S^{\omega}(x) = \sum_{s \in S} x^{\omega(s)} = \sum_{k=0}^{\infty} |S_k|x^k$

Here $S_k$ is all subsets of $\{1,\ldots,n\}$ of size $k$.

Hence, $|S_k|=\binom{n}{k}$

This gives $\Phi_{S}^{\omega}(x) = \sum_{k=0}^{\infty}\binom{n}{k}x^k = \sum_{k=0}^{n}\binom{n}{k}x^k$


$A =$ subsets of $\{1,\ldots,n\}$ that contain $n$. 

$A_k =$ subsets of $\{1,\ldots,n\}$ that contain $n$ and are of size $k$. 

There is a natural bijection from $A_n$ to $\Tilde{A_k} =$ subsets $\{1,\ldots,n-1\}$ of size $k-1$.


This is given by $\{c_1,c_2,\ldots,c_{k-1},n\} \to \{c_1,\ldots,c_{k-1}\}$

The inverse is $\{c_1,\ldots,c_{k-1}\} \to \{c_1,c_2,\ldots,c_{k-1},n\}$

This gives us 
\begin{align*}
\Phi_A^{\omega}(x) = \sum_{k=0}^{\infty}|A_k|x^k &= \sum_{k=0}^{\infty}|\Tilde{A_k}|x^k \\
&= \sum_{k=0}^{\infty}\binom{n-1}{k-1}x^k
\end{align*}

$B_m = $ the subsets of size $k$ from $\{1,\ldots,n\}$ that do not contain $n$. We can equivalently think of $B_m$ as the subsets of size $k$ from $\{1,\ldots,n-1\}$. 

This gives $\Phi_B^{\omega}(x) = \sum_{k=0}^{\infty}|B_k|x^k = \sum_{k=0}^{\infty}\binom{n-1}{k}x^k$

By the Sum Lemma, we have:

\begin{align*}
\Phi_S^{\omega}(x) &= \Phi_A^{\omega}(x) + \Phi_B^{\omega}(x) \text{ or} \\
\sum_{k=0}^{\infty}\binom{n}{k}x^k &= \sum_{k=0}^{\infty}\binom{n-1}{k-1}x^k + \sum_{k=0}^{\infty}\binom{n-1}{k}x^k
\end{align*}

Considering $[x^k]$ of both sides we get: $\binom{n}{k} = \binom{n-1}{k-1} + \binom{n-1}{k}$

\subsection{Product Lemma}

\underline{Theorem}

Let $A$ be a set with weight function, $\omega$, and $B$ be a set with weight function $\upsilon$, we define:

$S = A \times B = \{(a,b): a \in A, b \in B\}$

We define a weight function on $S$ as:

$\mu(s) = \omega + \upsilon(s) = \omega \times \upsilon((a,b)) = \omega(a) + \upsilon(b)$

Then
\begin{align*}
\Phi_S^{\mu}(x) = \Phi_{A \times B}^{\omega \times \upsilon}(x) = \Phi_{A}^{\omega}(x) \cdot \Phi_{B}^{\upsilon}(x)
\end{align*}

\underline{Proof}

\begin{align*}
\Phi_{S}^{\sigma}(x) &= \sum_{s \in S}x^{\sigma(s)} \\
&= \sum_{(a,b) \in A \times B} x^{\omega(a) + \upsilon(b)} \\
&= \sum_{a \in A} \sum_{b \in B} x^{\omega(a)}x^{\upsilon(b)} \\ 
&= (\sum_{a \in A} x^{\omega(a)})(\sum_{b \in B}x^{\upsilon(b)}) \\
&= \Phi_{A}^{\omega}(x) \cdot \Phi_{B}^{\upsilon}(x)
\end{align*}

\underline{Example}

Let $A = \{1,2,3,4,5,6\}$ be the possibilities of a die. Let $\omega(a) = a$.

So $\Phi_{A}^{\omega}(x) = x+x^2+x^3+x^4+x^5+x^6$

Let $S = A \times A = \{(a,b) : a,b \in A\} = \{(1,1),(1,2),\ldots,(2,1)\ldots,\}$

In this case:

\begin{align*}
\Phi_{A \times A}(x) &= \Phi_{A}(x) \cdot \Phi_{A}(x) \\
&= (\Phi_{A}(x))^2 \\
&= (x+x^2+x^3+x^4+x^5+x^6)^2 \\
&= x^2 + 2x^3 + 3x^4 + \underbrace{4x^5}_{4\text{ ways to roll two dice such that their sum is equal to } 5} + 5x^6 + \ldots
\end{align*}

\underline{Recall}

\underline{Theorem}

Let $A$ and $B$ be sets with weight $\omega$ and $\upsilon$. We define $A \times B = \{(a,b):a \in A, b \in B\}$ and $\omega \times \upsilon : A \times B \to N$ by $(\omega \times \upsilon)((a,b)) = \omega(a) + \upsilon(b)$

Then $\Phi_{A \times B}^{\omega \times \upsilon} = \Phi_{A}^{\omega}(x) \cdot \Phi_{B}^{\upsilon}(x)$

We can apply this theorem to higher products.

\subsection{Infinite Sum Lemma}

Notation

$A^k = \underbrace{A \times \ldots \times A}_{k \text{ times}} = \{(a_1,\ldots,a_k):a_i \in A\}$

We similarly define

$\omega^k = \underbrace{\omega \times \ldots \times \omega}_{k \text{ times}}$, by

$(\omega^k)(a_1, \ldots, a_k) = \omega(a_1) + \omega(a_2) + \ldots + \omega(a_k)$

\underline{Define}

\begin{align*}
A^* = \bigcup_{k=0}^{\infty}A^k
\end{align*}

\underline{Example}

Let $A = \{0,1\}$

$A^* = A^0 \cup A^1 \cup A^2 \cup \ldots$

$ = \{(),(0),(1),(0,0),(0,1),(1,0),(1,1)\}$

We define $\omega^{*} : A^{*} \to \mathbb{N}$ by the property if $a \in A^{k}$ then $\omega^{*}(a) = \omega^{k}(a)$

\underline{Example}

Let $A = \{1,2\}$ and $\omega: A \to \mathbb{N}$ by $\omega(1) = 1, \omega(2) = 2$.

Then $(1,2,2,1,1) \in A^*$

$w^*((1,2,2,1,1)) = w^5((1,2,2,1,1)) = 7$

There will be situations where $\omega^*$ is not a weight function. For example, if there exists $a \in A$ with $\omega(A) = 0$.

Then $\omega^*(a)=0$, $\omega^*((a,a)) = 0+0=0$

$\omega^*((a_1,\ldots,a_k)) = 0$

Hence $(\omega^*)^{-1}(0) = \{\epsilon, (a),(a,a),(a,a,a),\ldots\}$

\underline{Theorem}

Let $A$ be a set and $\omega: A \to \mathbb{N}$ a weight function such that $\omega(a) \ne 0, \forall a \in A$. Then,

\begin{align*}
\Phi_{A^*}^{\omega^*}(x) &= \frac{1}{1- \Phi_{A}^{\omega}(x)} \\
\Phi_{A^*}^{\omega^*}(x) &= \Phi_{\bigcup_{k=0}^{\infty}A^k}^{\omega^*}(x) \\
&= \sum_{k=0}^{\infty}\Phi_{A^k}^{\omega^*}(x) \\
&= \sum_{k=0}^{\infty}\Phi_{A^k}^{\omega^k}(x) \\
&= \sum_{k=0}^{\infty}(\Phi_{A}^{\omega}(x))^k \\
&= \frac{1}{1-\Phi_{A}^{k}}
\end{align*}

\underline{Example}

Let $A = \{1,2\}$ and $\omega:A \to \mathbb{N}$ as before with $\omega(1)=1$, $\omega(2)=2$.

$A^* = \{(),(1),(1,1),(1,2),(2,1),(2,2)\}$

\begin{align*}
\Phi_{A}^{\omega}(x) &= x^{\omega(1)} + x^{\omega(2)} = x^1 + x^2 \\
\Phi_{A^*}^{\omega^*}(x) &= \frac{1}{1-\Phi_{A}^{\omega}(x)} \\
&= \frac{1}{1-x-x^2} \\
&= 1 + x + 2x^2 + 3x^3 + 5x^4 + \ldots
\end{align*}

We notice in this case that

$[x^4]\Phi_{A^*}^{\omega^*}(x) = 5$

These correspond to

$(1,1,1,1),(1,1,2),(1,2,1),(2,1,1),(2,2)$

These are the $5$ lists in $A^*$ of any length using $1$ and $2$ that add to $4$. 

\subsection{Compositions}

\underline{Definition}

A composition is a list of positive integers. $(a_1,\ldots,a_k)$

The entries $a_i$ are the parts.

The length of a composition $(a_1,\ldots,a_k)$ is $k$. 

The size is $|(a_1,\ldots,a_k)| = a_1 + \ldots + a_k$

\underline{Examples}

The compositions of $4$ include

$(1,1,1,1),(2,1,1),(1,1,2),(1,2,1),(2,2)$ from the last example.

The last three examples are

$(1,3),(3,1),(4)$.

Let $\mathcal{C}$ be the set of all compositions. What is

$\Phi_{\mathcal{C}}^{\text{size}}(x)$

We know that there are $8$ compositions of size $4$, for example. 

Let $\mathcal{C}_1$ be all the compositions of length $1$. $\mathcal{C}_2$ of length $2$, etc.

Then 

$\mathcal{C}_1 = \{(1),(2),(3),(4),\ldots\}$

$\mathcal{C}_2 = \{(1,1),(1,2),(2,1),(2,2),(1,3),\ldots\}$

We have $\Phi_{\mathcal{C}_1}^{\text{size}} = x + x^2 + x^3 = \frac{x}{1-x}$

We note that $\mathcal{C}_2 = \mathcal{C}_1 \times \mathcal{C}_1$ and in general, $\mathcal{C}_k = (\mathcal{C}_1)^k$

This allows us to write

\begin{align*}
    \Phi_{\mathcal{C}}^{\text{size}}(x) &= \sum_{k=0}^{\infty}\Phi_{\mathcal{C}}^{\text{size}} \\
    &= \sum_{k=0}^{\infty}(\Phi_{\mathcal{C}_1}^{\text{size}}(x))^k \\
    &= \frac{1}{1-\Phi_{\mathcal{C}_1}^{\text{size}}(x)} \\
    &= \frac{1}{1-\frac{x}{1-x}} \\
    &= \frac{1-x}{1-2x} \\
    &= 1 + x^2 + 2x^2 + 4x^3 + 8x^4 + \ldots
\end{align*}

From this we conclude that the number of compositions of size k is,

\begin{align*}
\begin{cases}
    2^{k-1} \text{ if } k \ge 1 \\
    1 \text{ if } k = 0
\end{cases}
\end{align*}


\underline{Example}

Let $g_n$ be the number of compositions of $n$ into $2$ or more parts using only the numbers $1, 3,$ or $7$. Find an expression for $\sum_{n=0}^{\infty}g_nx^n$.


For example,

Weight $2 \rightarrow (1,1)$ 

Weight $3 \rightarrow (1,1,1)$

Weight $4 \rightarrow (1,3),(3,1),(1,1,1,1)$

Let $A$ be the set $\{1,3,7\}.$ We will only be looking at $A^2, A^3, A^4, \ldots$

We see $\Phi_{A}(x) = x^1 + x^3 + x^7$

The generating series we are interested in is

\begin{align*}
\sum_{n=2}^{\infty}\Phi_{A^n}(x)
&= \sum_{n=2}^{\infty}(\Phi_{A}(x))^2
\end{align*}

Note 
\begin{align*}
\sum_{n=2}^{\infty}y^n = y^2\sum_{n=0}^{\infty}y^n = \frac{y^2}{1-y}
\end{align*}

This allows us to find the generating series we want as

\begin{align*}
    \sum_{n=2}^{\infty}(\Phi_{A}(x))^n = \frac{(\Phi_{A}(x))^2}{1-\Phi_{A}(x)} = \frac{(x+x^3+x^7)^2}{1-x-x^3-x^7}
\end{align*}

Note

\begin{align*}
    \Phi_{A}(x) &= \sum_{a \in A}x^{(\omega(a))} \\
    &= \sum_{a \in \{1,3,7\}} x^{\omega(a)} \\
    &= x^{\omega(1)} + x^{\omega(3)} + x^{\omega(7)} \\
    &= x + x^3 + x^7
\end{align*}

\underline{Example}

Find the number of partitions of $n$, using only odd numbers, into an odd number of parts. Find the generating series.

\underline{Examples}

$(1),(3),(5),(7)$

$(1,1,1),(1,1,3),(1,3,1),(3,1,1),(1,3,3)$

$(1,1,1,1,1)$

As before it is useful to determine the generating series into exactly $1$ part. 

In this case, $A = \{1,3,5,7,\ldots\}$

So 

\begin{align*}
    \Phi_{A}(x) = \sum_{a \text{ odd}}x^{\omega(a)} = \sum_{a \text{ odd}} x + x^3 + x^5 + x^7 + \ldots
\end{align*}

Note

\begin{align*}
    x + x^3 + x^5 + x^7 + \ldots \\
    &= x(1 + x^2 + x^4 + x^6 \ldots ) \\
    &= x(1+(x^2)^1 + (x^2)^2) + (x^2)^3) + \ldots )
\end{align*}

This gives us that

\begin{align*}
    \Phi_{A}(x) &= x + x^3 + x^5 \\
    &= x(1+(x^2)^1 + (x^2)^2 + \ldots ) \\
    &= \frac{x}{1-x^2}
\end{align*}

To find the generating series into an odd number of parts.

\begin{align*}
    \sum_{n \text{ odd}}\Phi_{A^n}(x) &= \sum_{n \text{ odd}}(\Phi_{A}(x))^n \\
    &= \frac{\Phi_{A}(x)}{1-\Phi_{A}(x)^2} = \frac{\frac{x}{1-x^2}}{1-(\frac{x}{1-x^2})^2} = \frac{x-x^3}{1-3x^4+x^4} \\
    &= x+2x^3 + 5x^5 + 13x^7 + 34x^9 + \ldots
\end{align*}

This last step is just to double check you didn't make a mistake. If any coefficients are negative, you made a mistake. If any of the small coefficients do not match up with an exhaustive set, you made a mistake. 

From the series there should be $5$ compositions of $5$ into an odd number of odd parts.

$(1,1,1,1,1)$

$(1,1,3), (1,3,1), (3,1,1)$

$(5)$


\section{Binary Strings}

\underline{Define}

A binary string is of the form $a_1, a_2, \ldots, a_n$ where $a_i \in \{0,1\}$

$(000,10110,100000001,\ldots)$

The \underline{length} of $a_1 \ldots a_n$ is $n$. We often use this as our weight function. 

We use $\epsilon$ to represent the empty string. (i.e. the string of length $0$). 

If $A = \{0,1\}$ is the binary strings of length $1$, we use $A^2 = \{00,01,10,11\}$

(This is the same as $\{(0,0),(0,1),(1,0),(1,1)\}$ from before but is easier to write). 

As before

$\{0,1\}^* = \bigcup_{k=0}^{\infty}\{0,1\}^k = $ set of all binary strings including $\epsilon$.


\underline{Example} Let $B$ be the set of all binary strings. Then

\begin{align*}
    \Phi_{B}^{\text{length}}(x) &= \Phi_{\{0,1\}^*}^{\text{length}}(x) \\
    &= \sum_{k=0}^{\infty}\Phi_{\{0,1\}^k}(x) \\
    &= \sum_{k=0}^{\infty}(\Phi_{\{0,1\}}(x))^k
\end{align*}

Here, 

\begin{align*}
    \Phi_{\{0,1\}}^{\text{length}}(x) = x^{\text{length}(0)} + x^{\text{length}(1)} = x + x = 2x
\end{align*}

This gives,

\begin{align*}
    \Phi_{B}^{\text{length}}(x) = \frac{1}{1-2x} = 1 + 2x + 4x^2 + 8x^3 + 16x^4 + \ldots
\end{align*}

\subsection{Regular Expressions \& Rational Languages}

\underline{Definition}

(Note: This is also discussed in CS360, CS365)

$\epsilon,0,1$ are all regular expressions.

If $R$ and $S$ are regular expressions, then so is $R \smile S$. This can be read as "or".

If $R$ and $S$ are regular expressions, then so is $RS$.

\underline{Example}

$0,1$ are regular expressions. Hence $00$ is a regular expression as is $10$. Hence so is $00 \smile 11$. This represents the binary strings $\{00,10\}$.

Hence so is $(00 \smile 10)(00 \smile 10)$

This gives $\{0000,0010,1000,1010\}$ as the words represented.

If $R$ is a regular expression, so is $R^k$ for $k \ge 0$. This is $R^k = \underbrace{RR \ldots R}_{\text{k times}}$

If $R$ is a regular expression, so is $R^*$

Here $R^* = \underbrace{\epsilon \smile R^1 \smile R^2 \smile R^3 \smile R^4 \smile \ldots}_{\text{forever}}$

\underline{Recall}

\underline{Definition}

Let $R$ and $S$ be regular expressions. 

\begin{itemize}
    \item $\epsilon, 0, 1$ are regular expressions
    \item $R \smile S$ is a regular expression
    \item $RS$ is a regular expression
    \item $R^k = \underbrace{RR\ldots R}_{k}$ is a regular expression
    \item $R^* = \epsilon \smile R \smile R^2 \ldots $ is a regular expression
\end{itemize}

\underline{Example} Consider $(0(00\smile11)^2)^*$

This is a regular expression, but what does it mean?

We see $\epsilon$ is a word described by this regular expression

$0.00.00, 0.00.11, 0.11.00, 0.11.11$ are all words given by the regular expression $0(00\smile11)^2$, and hence given by this regular expression

\underline{Notice}

$0(00\smile11)^2 = 0(00\smile11)(00\smile11)$

We also have $16$ words of length $10$ given by this expression. This comes from $(0(00\smile11)^2)^2$

Note $(0(00\smile11)^2)^2 = 0(00\smile11)^20(00\smile11)^2 = 0(00\smile11)(00\smile11)0(00\smile11)(00\smile11)$

This includes

$0.00.00.0.00.00$ \\
$0.00.11.0.11.11$ \\
$0.11.00.0.11.0.0$ etc.

There are $13$ more that are not listed.

Often for regular expressions, we wish to count the number of binary strings represented by this expression of a particular length. 

In this case there is one word of length $0$, (namely $\epsilon$)

There are $4$ words of length $5$

There are $4^2$ words of length $10$

In this case we can create a generating series $\sum{}{}a_nx^n$ where $a_n = \#$ of binary strings of length $n$ given by the regular expression.

We have in this case that

\begin{align*}
    \sum_{n=0}^{\infty} &= 1 + 4x^5 + 16x^{10} = 4^3x^{15} + \ldots \\
    &= 1 + 4x^5 + (4x^5)^2 + (4x^5)^3 \\
    &= \frac{1}{1-4x^5}
\end{align*}

\underline{Definition}

Let $\mc{R}$ and $\mc{S}$ be sets of binary strings. We denote $\mc{RS} = \{\alpha\beta : \alpha \in \mc{R}, \beta \in \mc{S}\}$

\underline{Example}

$\mc{R} = \{0,00,000,0000,\ldots\} = $ all non-empty binary strings with only $0$

$\mc{S} = \{1,11,111\}$

$\mc{RS} = \{01,011,0111,001,0011,0011,\ldots\}$

$\mc{SR} = \{10,110,1110,100,1100,11100,\ldots\}$

$\mc{RR} = \{00,000,0000,\ldots\} = R \setminus \{0\}$

$\mc{SS} = \{11,111,1111,11111,111111\}$

\underline{Definition}

Let $R$ be a regular expression representing the words $\mc{R}$. 

Let $S$ be a regular expression representing the binary strings $\mc{S}$.

The $\epsilon, 0, 1$ are regular expressions representing the set $\{\epsilon\}, \{0\},\{1\}$ respectively. 

Then $R \smile S$ is a regular expression representing the strings $\mc{R} \cup \mc{S}$. 

Then $RS$ is a regular expression representing the strings $\mc{RS}$. 

Then $R^k = \underbrace{R...R}_{k}$ is a regular expression representing the language $\underbrace{\mc{R}\ldots\mc{R}}_{k} = \{\alpha_1, \ldots, \alpha_k : \alpha_i \in \mc{R}\} = \mc{R}^k$

$R^* = \epsilon \smile R \smile R^2 \smile R^3 \smile \ldots$ is a regular expression for the set of strings $\mc{R}^* = \{\epsilon\} \cup \mc{R} \cup \mc{R}^2 \cup \mc{R}^3 \cup \ldots = \bigcup_{k=0}^{\infty}\mc{R}^k$

\underline{Definition}

Let $R$ be a regular expression. Then $\mc{R}$, the set of binary strings represented by $R$ is called a rational language (or a regular language). 

\underline{Note}

Not all subsets of binary strings are rational languages. For example, $\{0^n,1^n\}_{n=0}^{\infty} = \{\epsilon, 01,0011,000111,\ldots\}$ is not a rational language.

\underline{Example}

$\{0^p\}_{\text{p-prime}} = \{00,000,00000,\ldots\}$ is not a rational language.

\underline{Example}

Any finite set $\mc{R}$ is a rational language.

\subsection{Ambiguous vs Unambiguous}

Consider the two regular expressions.

$(1\smile11)^*$ and $1^*$. These both give the rational language $\{\epsilon, 1, 11, 111, 1111,\ldots\}$

We see that $(1\smile11)^*$ represents $111$ in three different ways. We have

$1.1.1$ or $1.11$, $11.1$

We see $1^*$ has only one way to do this. Namely $1.1.1$.

Ambiguous \& Unambiguous Expressions

\underline{Definition}

We say a regular expression is unambiguous if \underline{every} string in the rational language is uniquely given by a unique representation. We say a regular expression is ambiguous if it is not ambiguous. Equivalently, there is at least one word in the language with at least two representations. 

\underline{Example}

$(1\smile0)(00\smile0)$

This is ambiguous. Notice

$00 = 0.0 = \epsilon.00$

\underline{Example}

$1^*(00\smile0)$

We see that a word starts with some number of $1$s, that is described uniquely by $1^*$, and ends with $0$ or $00$, which again is unique. 

This example is unambiguous. 

\underline{Lemma}

Let $R$ and $S$ be regular expressions which are unambiguous. 

Let their rational languages be $\mc{R}$ and $\mc{S}$

Then $\epsilon, 0, 1$ are all unambiguous

The regular expression $R \cup S$ is unambiguous if and only if $\mc{R} \cap \mc{S} = \emptyset$

The regular expression $RS$ is unambiguous if and only if there is a bijection from $\mc{RS}$ to $\mc{R} \times \mc{S}$

I.e. for every $\alpha \in \mc{RS}$, there is a unique $r \in \mc{R}$ and $s \in \mc{S}$ such that $\alpha = rs$

$R^*$ is unambiguous if and only if $R^k$ is unambiguous for all $k$ and $R^k \cap R^n = \emptyset$ for all $k \ne n$

\underline{Example}

$(\epsilon \smile 0)(0 \smile 00)$

Notice $(\epsilon \smile 0)$ is unambiguous as $\{\epsilon\} \cap \{0\} = \emptyset$. This has language $\{\epsilon, 0\}$

Similarly, $0\smile00$ is an unambiguous expression for $\{0,00\}$

Consider $(\epsilon \smile 0)(0 \smile 00)$

$\{\epsilon, 0\}\{0,00\} = \{\epsilon.0, \epsilon.00, 0.0,0.00\} = \{0,00,000\}$


$\{\epsilon, 0\} \times \{0,00\} = \{(\epsilon,0),(\epsilon,00),(0,0),(0,00)\}$

In this case $\{\epsilon,0\}\{0,00\}$ is size $3$ and $\{\epsilon,0\} \times \{0,00\}$ is size $4$.

Hence there does not exist a bijection, and $(\epsilon \smile 0)(0 \smile 00)$ is ambiguous.

\underline{Theorem}

Let $R$ and $S$ be unambiguous expressions with languages $\mc{R}$ and $\mc{S}$ and generating series $\Phi_{\mc{R}}, \Phi_{\mc{S}}$ (with weight function $=$ length of binary string).

$\epsilon, 0, 1$ are unambiguous regular expressions with languages $\{\epsilon\}, \{0\},\{1\},$ and generating series $\Phi_{\{\epsilon\}}(x) = x^{\text{length}(\epsilon)} = x^0 = 1$

$\Phi_{\{0\}}(x) = x^\text{length}(0) = x^1 = x. \Phi_{\{1\}}(x) = x^\text{length}(1) = x^1 = x$

\underline{Sum Lemma}

Assume $R \smile S$ is unambiguous, and is associated to the language $\mc{R} \cup \mc{S}$. Further

\begin{align*}
    \Phi_{\mc{R} \cup \mc{S}}(x) = \Phi_{\mc{R}}(x) + \Phi_{\mc{S}}(x)
\end{align*}

\underline{Product Lemma}

Assume $RS$ is an unambiguous expression for $\mc{RS}$ (which has a bijection to $\mc{R} \times \mc{S}$). Further

\begin{align*}
    \Phi_{\mc{RS}}(x) = \Phi_{\mc{R} \times \mc{S}}(x) = \Phi_{\mc{R}}(x) \cdot \Phi_{\mc{S}}(x)
\end{align*}


\underline{String Lemma}

Assume $R^*$ is unambiguous with language $R^*$. Then

\begin{align*}
    \Phi_{\mc{R}^*}(x) = \frac{1}{1-\Phi_{\mc{R}}(x)}
\end{align*}

\underline{Example}

The regular expression $0^*(100^*)^*(\epsilon \smile 1)$ is unambiguous.

Let $\mc{S}$ be the language represented by this expression. Find $\Phi_{\mc{S}}(x)$

$0$ has generating series $\Phi_{\{0\}}(x) = x$

$0^*$ has generating series $\Phi_{\{0\}^*}(x) = \frac{1}{1-\Phi_{\{0\}}(x)} = \frac{1}{1-x}$

Next 

\begin{align*}
    \Phi_{\{10\}\{0\}^*}(x) &= \Phi_{\{1\}}(x) \cdot \Phi_{\{0\}}(x) \cdot \Phi_{\{0\}^*}(x) \\
    &= x \cdot x \cdot (\frac{1}{1-x}) \\
    &= \frac{x^2}{1-x}
\end{align*}

This gives the generating series associated to $(100^*)^*$ as

\begin{align*}
    \frac{1}{1-\Phi_{\{10\}\{0\}^*}(x)} = \frac{1}{1-\frac{x^2}{1-x}}
\end{align*}

Lastly $\Phi_{\{\epsilon,1\}}(x) = \Phi_{\{\epsilon\}}(x) + \Phi_{\{1\}}(x) = 1 + x$

Hence

\begin{align*}
    \Phi_{\mc{S}}(x) &= \frac{1}{1-x} \cdot \frac{1}{1-\frac{x^2}{1-x}} \cdot (1+x) \\
    &= \frac{1+x}{1-x-x^2}
\end{align*}

\underline{Note}

We can do this on ambiguous expressions, but the coefficients can include over-counts and be too high.


\subsection{Block \& Prefix Decomposition}

We see that having an unambiguous regular expression allows us to construct a generating series for the language with respect to the length.

One way to do this is to decompose the strings in an unambiguous way, and construct the regular expression for this.

\underline{Block Decomposition}

We will decompose a string into alternating "blocks" of 0's and 1's.

\underline{Example}

$11010001110101$

$11.0.1.000.111.0.1.0.1$

A non-empty block of $0$'s can be represented by $00^*$.
A non-empty block of $1$'s can be represented by $11^*$.

If we alternate these, we could have, for example,

$00^*11^*00^*11^*00^*$

We can represent all binary strings by the unambiguous block decompositions

$1^*(00^*11^*)^*0^*$

or 

$0^*(11^*00^*)^*1^*$

\underline{Example}

Find a regular expression (unambiguous) where all blocks of 0 even length can be represented.

Notice a non-empty block of $0$'s of even length can be represented by 

$00(00)^*$. If we also wanted to allow an empty block, we can use $(00)^*$

Binary Strings $1^*(00^*11^*)^*0^*$

New Set $1^*(\underbrace{00(00)^*}_{\text{even length, non-empty}}11^*)^*\underbrace{(00)^*}_{\text{even length, possibly empty}}$

\underline{Example}

All blocks are odd length

Blocks of 1's, possibly empty, of odd length

$\epsilon \smile 1(11)^*$

Blocks of 0's, non-empty, odd length

$0(00)^*$

Blocks of 1's, non-empty, odd length

$1(11)^*$

Block of 0's, possibly empty, odd length

$(\epsilon \smile 0(00)^*$

All binary strings

$1^*(00^*11^*)^*0^*$

$(\epsilon \smile 1(11)^*)(0(00)^*1(11)^*)^*(\epsilon \smile 0(00)^*)$

New expression

Another common type of decomposition is called prefix decomposition.

\underline{Prefix Decomposition}


The idea is every part starts with 1 and every 1 starts a part.

\underline{Example}

$00110001001101$

$00.1.1000.100.1.10.1$

Every part looks like $10^*$. We need to allow the word to start with some number of 0's. 

This gives us a decomposition of $0^*(10^*)^*$

(Note, we could decompose based on 0's, or based on suffixes). 

\underline{Example}

Find an unambiguous regular expression where every 1 is followed by at least two 0's. 

Here $10^*$ is a 1 followed by any number of 0's. We can modify this to give $1000^*$, where every 1 is followed by at least two 0's. 

All binary strings $0^*(10^*)^*$

New expression $0^*(1000^*)^*$

\underline{Aside}

There are multiple ways to represent all binary strings. The easiest, but least useful is $(0 \smile 1)^*$.

\underline{Example}

We have an unambiguous regular expression for all words where 1 is followed by at least two 0's. Let this language by $\mc{R}$. Find $\Phi_{\mc{R}}(x)$.

Here the regular expression is $0^*(1000^*)^*$

Notice the generating series for the part coming from $0^*$ is $\frac{1}{1-x}$

The generating series corresponding to $1000^*$ is $\frac{x^3}{1-x}$.

Putting this together gives $(\frac{1}{1-x})(\frac{1}{1-\frac{x^3}{1-x}})$

This can be simplified to the form $\frac{\text{polynomial}}{\text{polynomial}}$.


\subsection{Recursive Decomposition}

\underline{Recursive Decomposition}

Another way we can describe a language is recursively. It is possible that such a language is \underline{not} a rational language. Despite this, we can often still use this decomposition to say something meaningful about the language via generating series.

We need this decomposition to be unambiguous for this to work.

\underline{Example}

Let $\mc{S}$ be the set of binary strings where all blocks of 1's are even, and all blocks of 0's are of length divisible by 3.

For any word in $\mc{S}$, either it is $\epsilon$, or it starts with 0, or it starts with 1. As all blocks of 0 have length divisible by 3, if it starts with 0, then it has to start with $000$. Similarly, if it starts with 1, it in fact starts with $11$. 

Here if $S$ is the "regular expression", then we have 

$S = (\epsilon \smile 11S \smile 000S)$

This allows us to say something about the generating series.

\begin{align*}
    \Phi_{\mc{S}}(x) &= \Phi_{\{\epsilon\}}(x) + \Phi_{\{11\}}(x) \Phi_{\{\mc{S}\}}(x) + \Phi_{\{000\}}(x) + \Phi_{\{\mc{S}\}}(x) \\
    &= 1 + x^2 \cdot \Phi_{\mc{S}}(x) + x^3 \cdot \Phi_{\mc{S}}(x) \\
    &\implies \Phi_{\mc{S}}(x) - x^2 \Phi_{\mc{S}}(x) - x^3\Phi_{\mc{S}}(x) = 1
\end{align*}

Hence

\begin{align*}
    \Phi_{\mc{S}}(x)(1-x^2-x^3) = 1 \text{ or} \\
    \Phi_{\mc{S}}(x) = \frac{1}{1-x^2-x^3}
\end{align*}

\underline{Note}

This language is in fact rational, and has block decomposition

$(11)^*(000(000)^*(11)(11)^*)^*(000)^*$

\underline{Example}

Let $\mc{R} = \{0^n1^n\}_{n=0}^{\infty} = \{\epsilon, 01, 0011, 000111,\ldots \}$

We see $\mc{R}$ is either empty, $\epsilon$, or it starts with a 0 and ends with a 1, and the middle part (after removing the first and last term) is in $\mc{R}$.

This gives us $R = 0R1 \smile \epsilon$

Hence the generating series looks like

\begin{align*}
    \Phi_{\mc{R}}(x) &= \Phi_{\{\epsilon\}}(x) + \Phi_{\{0\}}(x) \Phi_{\{\mc{R}\}}(x) \Phi_{\{1\}}(x) \\
    &\implies \Phi_{\mc{R}}(x) = 1 + x \Phi_{\mc{R}}(x)x \\
    &\implies \Phi_{\mc{R}}(x)(1-x^2) = 1 \\
    &\implies \Phi_{\mc{R}}(x) = \frac{1}{1-x^2} = 1 + x^2 + x^4 + x^6 + \ldots
\end{align*}

\underline{Example}

Let $\mc{R}$ be the language that does not contain $001$. It is useful to define $\mc{S}$ as the language that contains $001$ exactly once, at the very end. Let $R$ and $S$ be their expressions.

Notice $\mc{R} \cap \mc{S} = \emptyset$

Consider $R \cup S$. 

This is either $\epsilon$, or ends in 0, or ends in 1.

If it ends in 0, and we remove the final 0, then it will still not contain $001$ (i.e. it is in $\mc{R})$

If it ends in 1, and we remove the final 1, then it will not contain $001$ and hence is in $\mc{R}$.

This gives $R \smile S = \epsilon \smile R0 \smile R1$

\begin{align*}
    \implies \Phi_{\mc{R}}(x) + \Phi_{\mc{S}}(x) &= \Phi_{\{\epsilon\}}(x) + \Phi_{\mc{R}}(x) \Phi_{\{0\}}(x) + \Phi_{\mc{r}}(x) \Phi_{\{1\}}(x) \\
    &= 1 + \Phi_{\mc{R}} \cdot x + \Phi_{\mc{R}}(x) \cdot x \\
    &= 1 + 2x \Phi_{\mc{R}}(x)
\end{align*}

Consider a word $r_1r_2 \ldots r_n001$ represented by $S$. This cannot contain a $001$ anywhere in $r_1r_2 \ldots r_n00$ by assumption.

As $00$ at the end cannot create a $001$, we see $r_1r_2 \ldots r_n00$ does not contain a $001$ if and only if $r_1r_2 \ldots r_n$ does not contain a $001$.

This gives us $S = R001$

Hence $\Phi_{\mc{S}}(x) = x^3\Phi_{\mc{R}}(x)$

Combining the two equations gives

\begin{align*}
    \Phi_{\mc{R}}(x) + x^3\Phi_{\mc{R}}(x) - 2x\Phi_{\mc{R}}(x) = 1 \\
    \implies \Phi_{\mc{R}}(x) = \frac{1}{1-2x+x^3}
\end{align*}

\underline{Example}

Same as before, except use $000$ instead of $001$.

As before we have

\begin{align*}
    \Phi_{\mc{R}}(x) + \Phi_{\mc{S}}(x) = 1 + 2x \Phi_{\mc{R}}(x)
\end{align*}

The problem occurs when we try to do something like $S = R001$.

Consider $00 \in \mc{R}$

We see $00.000 \notin \mc{S}$

We see $\underline{000}00, 0\underline{000}0,00\underline{000}$ has multiple occurrences of $000$, two of them not at the end.

If $r_1 \ldots r_n = r_1r_2 \ldots r_{n-2}00 \in \mc{R}$

Then $r_1r_2 \ldots r_n 000 = \underbrace{(r_1r_2 \ldots r_{n-2}000)}_{\in \mc{S}}(00) \in \mc{S}(00)$

If $r_1r_2 \ldots r_n = r_1r_2 \ldots r_{n-1}0 \in \mc{R}$

$\implies r_1r_2 \ldots r_{n-1}0000 = (\underbrace{r_1r_2 \ldots r_{n-1}000}_{\in \mc{S}})(0) \in \mc{S}0$

This gives

$S \smile S0 \smile S00 = R000$

\begin{align*}
    &\implies \Phi_{\mc{S}}(x)(1+x+x^2) = x^3 \Phi_{\mc{R}}(x) \\
    &\implies \Phi_{\mc{R}}(x) + \frac{x^3}{1+x+x^2} \Phi_{\mc{R}}(x) = 1 + 2x \Phi_{\mc{R}}(x) \\
    &\implies \Phi_{\mc{R}}(x) = \frac{1+x^2+x^3}{1-x-x^2-x^3}
\end{align*}

\subsection{Excluded Substrings}

\underline{Theorem}

Let $\kappa \in \{0,1\}^*$ be a non-empty binary string of length $n$. Let $\mc{C}$ be the collection of non-empty suffixes $\gamma$ of $\kappa$ such that there exists a $n\kappa = \kappa \gamma$.

Let $C(x) = \sum_{\gamma \in \mc{C}} x^{\ell(\gamma)}$

Then the generating series for the language of binary strings not containing $\kappa$ is 

\begin{align*}
    \Phi(x) = \frac{1 + C(x)}{(1-2x)(1+C(x))+x^n}
\end{align*}

\underline{Example}

Let $k=000. n= \ell(000) = \ell(\kappa) = 3$

Notice the suffixes of $\kappa$ are $00$ and $0$. In this case 

$0.000 = 000.0$. 

$00.000 = 000.00$

In this case $\mc{C} = \{0,00\}$

This gives $C(x) = x^{\ell(0)} + x^{\ell(00)} = x + x^2$

This gives 

\begin{align*}
    \Phi(x) &= \frac{1+x+x^2}{(1-2x)(1+x+x^2)+x^3} \\
    &= \frac{1+x+x^2}{1-x-x^2-x^3}
\end{align*}

Why does this work? 

In the original method we always have

$R \smile S = \epsilon \smile R0 \smile R1$

($R$-language avoiding $\kappa$. $R$-language containing exactly one $\kappa$ at the end).

The second relationship depends on $\mc{C}$. Let $\mc{C} = \{\gamma_1, \ldots, \gamma_{\kappa}\}$

We get a new relation 

\begin{align*}
    R\kappa = S \smile S\gamma_1 \smile S\gamma_2 \smile \ldots \smile S\gamma_{\kappa}
\end{align*}

From these two relations we get the generating series

\begin{align*}
    \Phi_{\mc{R}}(x) + \Phi_{\mc{S}}(x) = 1 + 2x \Phi_{\mc{R}}(x)
\end{align*}

and 

\begin{align*}
    x^n \Phi_{\mc{R}}(x) &= \Phi_{\mc{S}}(x) + x^{\ell(\gamma)} \Phi_{\mc{S}}(x) + \ldots + x^{\ell(\gamma_\kappa)} \Phi_{\mc{S}}(x) \\
    &= (1 + C(x)) \Phi_{\mc{S}}(x)
\end{align*}

So $\Phi_{\mc{S}}(x) = \frac{x^n}{1+C(x)} \cdot \Phi_{\mc{R}}(x)$

After this it is just algebraic manipulation to solve for $\Phi_{\mc{R}}(x)$.

\underline{Example}

Let $\kappa = 1010$

$\mc{R}$ - avoid $\kappa$

$\mc{S}$ - $\kappa$ occurs exactly once at the end

$R \smile S = \epsilon \smile R0 \smile R1$

What happens if we append $\kappa$ to the end of a word in $R$.

If the word in $R$ ended with $10$, then

$r_1r_2 \ldots r_k 10 \kappa = r_1r_2 \ldots r_k 101010$

This is in $S10$.

In this case the $10$ corresponds to a $\gamma \in \mc{C}$ as $10 \kappa = \kappa 10 = 101010$

If the word does not end in $10$, then we are fine, and 

$r_1r_2 \ldots r_n 1010 \in \mc{S}$

Notice, the suffixes of $\kappa = 1010$ are 

$010,10,0.$

$n \kappa \ne \kappa0 = 10100$ 

$10 \kappa = \kappa10 = 101010$

$n\kappa \ne \kappa 010 = 1010010$

From here we get 

$R \kappa = S \smile S10$


\section{Recurrence Relations}

\subsection{Recurrences}

\underline{Example}

Let $g_0 = 1, g_1 = 1$ and $g_n = 2g_{n-1} + g_{n-2} \forall n \ge 2$

\underline{Questions}

What can we say about
\begin{align*}
    \sum_{n=0}^{\infty} g_n x^n
\end{align*}

Can we find a closed form for it? What can we do with this closed form?

First, find a closed form for

\begin{align*}
    G(x) &= \sum_{n=0}^{\infty}g_nx^n \\
    &= 1 + x + \sum_{n=2}^{\infty} g_n x^n \\
    &= 1 + x + \sum_{n=2}^{\infty}(2 g_{n-1} x^n + g_{n-2})x^n \\
    &= 1 + x + \sum_{n=2}^{\infty}2g_{n-2}x^n + \sum_{n=2}^{\infty}g_{n-2}x^n \\
    &= 1 + x + \sum_{n=2}^{\infty}2g_{n-1}x^n + x^2 \sum_{n=0}^{\infty}g_nx^n \\
    &= 1 + x + \sum_{n=2}^{\infty}2g_{n-1}x^n + x^2 G(x) \\
    &= 1 + x + 2x \sum_{n=2}^{\infty}g_{n-1}x^{n-1} + x^2 G(x) \\ 
    &= 1 + x + 2x(-g_0x^0 + \sum_{n=1}^{\infty}g_{n-1}x^{n-1})+ x^2 G(x) \\
    &= 1 + x + 2x(-1 + G(x)) + x^2 G(x) \\
    &= 1 + x - 2x + 2xG(x) + x^2 G(x) \\
    &\implies G(x) = 1-x+2xG(x)+x^2G(x) \\
    &\implies G(x)(1-2x-x^2) = 1 - x \\
    &\implies G(x) = \frac{1-x}{1-2x-x^2}
\end{align*}

This is our desired closed form expression.

\underline{Example}

Let $g_0 = g_1 = 1$, and $g_n = 2g_{n-1} + g_{n-2} \forall n \ge 2$

Last class we showed 

\begin{align*}
    G(x) = \sum_{n=0}^{\infty}g_nx^n = \frac{1-x}{1-2x-x^2}
\end{align*}

Consider $1-2x-x^2$. I want to write this as $(1-\alpha x)(1 - \beta x)$ for reasons that will make sense later.

Find the roots of $y^2 - 2y - 1$.

(This is $y^2P(\frac{1}{y})$ where $P(x) = 1 - 2x - x^2$)

By the quadratic formula, the roots of $y^2 - 2y - 1$ are $\frac{2 \pm \sqrt{4+4}}{2} = 1 \pm \sqrt{2}$.

This gives $y^2 - 2y - 1 = (y - (1 + \sqrt{2}))(y-(1-\sqrt{2}))$.

Equiv: $1-2x-x^2 = (1-(1+\sqrt{2})x)(1-(1-\sqrt{2})x)$

This gives us 

\begin{align*}
    \frac{1-x}{1-2x-x^2} = \frac{1-x}{(1-(1+\sqrt{2})x)(1-(1-\sqrt{2})x)}
\end{align*}

We can now do a partial fraction decomposition (Math $138$).

That is, we can find an $a$ \& $b$ such that

\begin{align*}
    \frac{1-x}{(1-(1+\sqrt{2})x)(1-(1-\sqrt{2})x)} = \frac{a}{(1-(1+\sqrt{2})x)} + \frac{b}{(1-(1-\sqrt{2})x)}
\end{align*}

Multiplying both sides by the denominator gives 

$1-x = a(1-(1-\sqrt{2})x) + b(1-(1+\sqrt{2})x)$

With a bit of trial and error, we see $a = \frac{1}{2}$ and $b = \frac{1}{2}$.

This gives us,

\begin{align*}
    G(x) = \sum_{n=0}^{\infty}g_nx^n = \frac{1-x}{1-2x-x^2} &= \frac{\frac{1}{2}}{(1-(1+\sqrt{2})x)} + \frac{\frac{1}{2}}{(1-(1-\sqrt{2})x)} \\ 
    &= \frac{1}{2} \sum_{n=0}^{\infty}(1+\sqrt{2})^n x^n + \frac{1}{2} \sum_{n=0}^{\infty}(1-\sqrt{2})^n x^n \\
    &= \sum_{n=0}^{\infty} \frac{1}{2} ((1+\sqrt{2})^n + (1-\sqrt{2})^n)x^n \\ 
    \text{This gives us } g_n &= \frac{1}{2}((1+\sqrt{2})^n + (1-\sqrt{2})^n).
\end{align*}

We notice in this case that $1-\sqrt{2} \approx -0.44$. This means that $(1-\sqrt{2})^n \to 0$ as $n \to \infty$. 

This means for large $n$ that
\begin{align*}
    g_n \approx \frac{1}{2}(1+\sqrt{2})^n
\end{align*}

Further, as $g_n$ are all integers, we see $\frac{1}{2}(1+\sqrt{2})^n$ is very close to an integer for large $n$. 

\subsection{Homogeneous Linear Recurrence Relations}

Let $a_1, a_2, \ldots, a_d$ be a set of complex numbers (typically integers). 

Let $g_0, g_1, \ldots, g_m$ be a set of initial conditions. Here $m \ge d-1$.

Then the sequence $g_1, g_2, \ldots$ is a homogeneous linear recurrence relation if for all $n \ge m+1$ we have 
\begin{align*}
    g_n + a_1g_{n-1} + \ldots + a_d g_{n-d} = 0
\end{align*}

\underline{Example}

Our previous example is an example of such a relation. Here $g_1 = g_0 = 1$, and 

\begin{align*}
    g_n - 2g_{n-1}-g_{n-2} = 0, \forall n \ge 2
\end{align*}

Here $a_1 = -2, a_2 = -1$. In the previous example, we had 

\begin{align*}
    G(x) = \sum_{n=0}^{\infty}g_n x^n = \frac{P(x)}{(1+a_1x+a_2x^2)} \text{for some polynomial } P(x)
\end{align*}

\underline{Theorem}

Let $g_n + a_1 g_{n-1} + \ldots + a_dg_{n-d} = 0$ be the recurrence relation. Then

\begin{align*}
    G(x) = \frac{b_mx^m + \ldots b_0}{1 + a_1x+a_2x^2 + \ldots + a_dx^d}
\end{align*}

where $b_k = g_k + a_1g_{k-1} + \ldots + a_dg_{k-d}$ 

where $g_n = 0$ if $n < 0$.

\underline{Example}

Let

\begin{align*}
    G(x) = \sum_{n=0}^{\infty}g_nx^n = \frac{2x^2-4x+3}{(1-2x)^2(1+x)}
\end{align*}

\begin{enumerate}
    \item Find a closed form for $g_n$
    \item Find initial conditions
    \item Find recurrence relations
\end{enumerate}

We know from partial fraction decomposition that there exists $a,b,$ and $c$ such that

\begin{align*}
    \frac{2x^2-4x+3}{(1-2x)^2(1+x)} = \frac{a}{(1-2x)} + \frac{b}{(1-2x)^2} + \frac{c}{(1+x)}
\end{align*}

Multiply by denominator
\begin{align*}
    2x^2 - 4x + 3 = a(1-2x)(1+x) + b(1+x) + c(1-2x)^2
\end{align*}

Evaluate at $x=-1$ gives, $c=1$

Evaluate at $x= \frac{1}{2}$ gives $b = 1$.

Knowing $c=1$ and $b=1$ we can simplify and get $a=1$.

Hence

\begin{align*}
    \frac{2x^2-4x+3}{(1-2x)^2(1+x)} = \frac{1}{1-2x} + \frac{1}{(1-2x)^2} + \frac{1}{1+x}
\end{align*}

This gives

\begin{align*}
    G(x) &= \sum_{n=0}^{\infty}2^nx^n + \frac{1}{(1-2x)^2} + \sum_{n=0}^{\infty}(-1)^nx^n \\
    &= \sum_{n=0}^{\infty}2^nx^n + \sum_{n=0}^{\infty}\binom{n+1}{1}2^nx^n + \sum_{n=0}^{\infty}(-1)^nx^n \\
    &= \sum_{n=0}^{\infty}(2^n = (n+1)2^n + (-1)^n)x^n \\
    &= \sum_{n=0}^{\infty}(2 \cdot 2^n + n2^n + (-1)^n)x^n
\end{align*}

Hence 
\begin{align*}
    &g_0 = 2 \cdot 2^0 + 0 \cdot 2^0 + (-1)^0 = 3 \\ 
    &g_1 = 2 \cdot 2^1 + 1 \cdot 2^1 + (-1)^1 = 5 \\
    &g_2 = 17
\end{align*}

Notice
\begin{align*}
    &(1-2x)^2(1+x) \\
    &= (1-4x+4x^2)(1+x) \\
    &= (1-3x + 0 + 4x^3) \\
    &\implies g_n = 3g_{n-1} + 0 g_{n-2} + 4g{n-3} \\
    &\implies g_n = 3g_{n-1} - 4g_{n-3}
\end{align*}

Linear Homogeneous Recurrence Equations

\underline{Version 1}

Initial conditions $g_0, g_1, \ldots, g_{d-1}$

Recurrence Equation $g_n + a_1g_{n-1}+\ldots+a_dg_{n-d}=0, \forall n \ge d$

\underline{Version 2}

\begin{align*}
    G(x) = \sum_{n=0}^{\infty}g_nx^n = \frac{P(x)}{Q(x)}
\end{align*}

Here, $Q(x) = 1 + a_1x^1 + a_2x^2 + \ldots a_dx^d$


\underline{Version 3}

Assume 

\begin{align*}
    Q(x) = (1-\lambda_1x)^{\alpha_1}(1-\lambda_2x)^{\alpha_2}\ldots(1-\lambda_kx)^{\alpha_k}
\end{align*}

Then there exists polynomials $P_1(x), P_2(x), \ldots, P_k(x)$ with $deg P_i(x) \le \alpha_i - 1$ such that 

\begin{align*}
    g_n = P_1(n)\lambda_1^n + P_2(n)\lambda_2^n + \ldots + P_k(n)\lambda_k^n
\end{align*}

\end{document} 